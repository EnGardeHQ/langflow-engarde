# =============================================================================
# EnGarde Platform - Root Environment Configuration
# This file contains cross-service environment variables
# Service-specific .env files should reference these values where applicable
# =============================================================================

# =============================================================================
# ENVIRONMENT & DEBUG SETTINGS
# =============================================================================
ENVIRONMENT=development
DEBUG=false
LOG_LEVEL=info
NODE_ENV=production

# =============================================================================
# CRITICAL SECRETS - MUST CHANGE IN PRODUCTION!
# =============================================================================
# Master Secrets (Used across services)
MASTER_SECRET_KEY=your-master-secret-key-min-32-chars-CHANGE-THIS
JWT_SECRET_KEY=a44fe15adf6a091dd88c6345d6eea0f66466a97708655f7046e8b2ec7b9cc0c3
NEXTAUTH_SECRET=your-nextauth-secret-min-32-chars-CHANGE-THIS
ENCRYPTION_KEY=your-encryption-key-32-bytes-base64-CHANGE-THIS

# =============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# =============================================================================
# Database Credentials
POSTGRES_DB=engarde
POSTGRES_USER=engarde_user
POSTGRES_PASSWORD=engarde_password_CHANGE_IN_PRODUCTION

# Connection URLs (Docker service names)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}
DATABASE_URL_EXTERNAL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@localhost:5432/${POSTGRES_DB}

# Database Pool Settings
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
# Redis Connection (Docker service names)
REDIS_URL=redis://redis:6379/0
REDIS_URL_EXTERNAL=redis://localhost:6379/0
REDIS_MARKETPLACE_URL=redis://redis:6379/1
REDIS_CELERY_URL=redis://redis:6379/2
REDIS_CACHE_URL=redis://redis:6379/3

# Redis Settings
REDIS_MAX_CONNECTIONS=50
REDIS_CACHE_TTL=3600
REDIS_SESSION_TTL=86400

# =============================================================================
# SERVICE URLS (Docker Compose Network)
# =============================================================================
# Backend Service
BACKEND_URL=http://backend:8000
BACKEND_URL_EXTERNAL=http://localhost:8000
API_V1_PREFIX=/api/v1

# Frontend Service
FRONTEND_URL=http://frontend:3000
FRONTEND_URL_EXTERNAL=http://localhost:3000

# Public URLs (for external access)
PUBLIC_BACKEND_URL=http://localhost:8000
PUBLIC_FRONTEND_URL=http://localhost:3001
NEXT_PUBLIC_API_URL=http://backend:8000

# =============================================================================
# CORS & ALLOWED ORIGINS
# =============================================================================
CORS_ORIGINS=http://localhost:3001,http://localhost:3000,http://frontend:3000,http://backend:8000
ALLOWED_HOSTS=localhost,127.0.0.1,frontend,backend,engarde.app
CSRF_TRUSTED_ORIGINS=http://localhost:3001,http://frontend:3000

# =============================================================================
# AI SERVICE CONFIGURATION (Optional)
# =============================================================================
# OpenAI
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=2000

# Anthropic Claude
ANTHROPIC_API_KEY=
ANTHROPIC_MODEL=claude-3-sonnet-20240229

# Google AI/Gemini
GOOGLE_AI_API_KEY=
GEMINI_API_KEY=
GOOGLE_CLOUD_PROJECT_ID=

# =============================================================================
# PAYMENT PROVIDERS (Optional)
# =============================================================================
# Stripe
STRIPE_PUBLISHABLE_KEY=pk_test_
STRIPE_SECRET_KEY=sk_test_
STRIPE_WEBHOOK_SECRET=whsec_

# PayPal
PAYPAL_CLIENT_ID=
PAYPAL_CLIENT_SECRET=
PAYPAL_WEBHOOK_SECRET=
PAYPAL_MODE=sandbox

# =============================================================================
# MARKETPLACE CONFIGURATION
# =============================================================================
MARKETPLACE_ENABLED=true
MARKETPLACE_COMMISSION_RATE=0.15
MARKETPLACE_CREDIT_USD_RATE=0.01
MARKETPLACE_CSV_UPLOAD_PATH=/app/marketplace/csv_imports
MARKETPLACE_MAX_FILE_SIZE=50MB

# Agent Settings
AGENT_APPROVAL_REQUIRED_THRESHOLD=100
AGENT_AUTO_APPROVE_FREE=true
AGENT_MAX_TAGS=10
AGENT_PUBLISHING_ENABLED=true

# =============================================================================
# EMAIL CONFIGURATION (Optional)
# =============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_TLS=true
SMTP_SSL=false
FROM_EMAIL=noreply@engarde.app
FROM_NAME=EnGarde Platform

# SendGrid Alternative
SENDGRID_API_KEY=

# =============================================================================
# MONITORING & OBSERVABILITY (Optional)
# =============================================================================
# Sentry Error Tracking
SENTRY_DSN=
SENTRY_ENVIRONMENT=${ENVIRONMENT}
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus Metrics
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
METRICS_ENABLED=true
METRICS_PORT=9090

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_AI_AGENTS=true
FEATURE_ANALYTICS=true
FEATURE_MARKETPLACE=true
FEATURE_WEBHOOKS=true
FEATURE_SSO=false
FEATURE_AUDIT_LOGGING=true
FEATURE_MULTI_TENANT=false
FEATURE_RATE_LIMITING=true

# Feature Toggle Settings
FEATURE_TOGGLES_ENABLED=true
FEATURE_TOGGLES_CACHE_TTL=300

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_BURST=200
RATE_LIMIT_WINDOW=60

# Security Headers
SECURE_SSL_REDIRECT=false
SECURE_HSTS_SECONDS=0
SECURE_CONTENT_TYPE_NOSNIFF=true
SECURE_BROWSER_XSS_FILTER=true
SECURE_FRAME_DENY=true

# Session Configuration
SESSION_TIMEOUT_MINUTES=480
SESSION_SECURE_COOKIES=false

# =============================================================================
# CELERY BACKGROUND TASKS
# =============================================================================
CELERY_BROKER_URL=${REDIS_CELERY_URL}
CELERY_RESULT_BACKEND=${REDIS_CELERY_URL}
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_TIMEZONE=UTC
CELERY_BEAT_SCHEDULE_ENABLED=true

# =============================================================================
# FILE STORAGE
# =============================================================================
# Local Development
UPLOAD_DIR=/app/uploads
MAX_UPLOAD_SIZE=10485760

# AWS S3 (Optional for production)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
AWS_S3_BUCKET=engarde-uploads

# MinIO (Local S3-compatible storage)
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=engarde_minio
S3_SECRET_KEY=engarde_minio_secret
S3_BUCKET_NAME=engarde-marketplace
S3_REGION=us-east-1

# =============================================================================
# LANGFLOW INTEGRATION (Optional)
# =============================================================================
LANGFLOW_BASE_URL=http://localhost:7860
LANGFLOW_API_KEY=
LANGFLOW_TIMEOUT=300
LANGFLOW_MAX_RETRIES=3

# =============================================================================
# PERFORMANCE SETTINGS
# =============================================================================
CACHE_TTL=3600
STATIC_FILE_CACHE=true
GZIP_COMPRESSION=true
DATABASE_CONNECTION_POOL_SIZE=20
WORKERS=4
MAX_WORKERS=8
WORKER_CONNECTIONS=1000

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================
AUTO_RELOAD=true
TEMPLATE_DEBUG=false
API_DOCS_URL=/docs
API_REDOC_URL=/redoc
DEV_HOT_RELOAD=true
NEXT_TELEMETRY_DISABLED=1
ANALYZE=false

# =============================================================================
# COMPLIANCE & AUDIT
# =============================================================================
GDPR_COMPLIANCE_MODE=false
AUDIT_LOG_RETENTION_DAYS=2555
DATA_ENCRYPTION_ENABLED=false
BACKUP_ENCRYPTION_ENABLED=false